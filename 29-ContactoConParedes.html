<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas id="myCanvas" width="1470" height="800" style="border: 2px solid black"></canvas>
	<script>
	//A esto le tenemos que agregar un objeto jugador
	//Y un objeto muro?
		const canvas = document.getElementById("myCanvas");
		const ctx = canvas.getContext("2d");
		let y = 250, x=250, w=100, w2=800;
		let dir = 0;
        let bandera = true;

		class Wall {
			constructor(x,y,width, height){
				this.width = width;
				this.height = height;
				this.x = x;
				this.y = y;
			}

			constructor(width, height){
				this.width = width;
				this.height = height;
				this.x = (Math.floor(Math.random() * 1270));
				this.y = (Math.floor(Math.random() * 600));
			}

			get xpos() {
				return this.x;
			}

			get ypos() {
				return this.y;
			}

			get width(){
				return this.x;
			}

			get height(){
				return this.x;
			}
		}

		class Player {
			constructor(x,y,width, height){
				this.width = width;
				this.height = height;
			}
		}

        //Obstaculos posiciones
        let cuadrados = [];
        //rellenar arreglo de obstaculos
        for (let index = 0; index < 2; index++) {
            cuadrados.push([(Math.floor(Math.random() * 1470)),(Math.floor(Math.random() * 800)),w,w2]); 
        }

        //Aca pintamos los elementos
		function repaint(){
			ctx.beginPath();
			ctx.fillStyle = "white";
			ctx.rect(0, 0, 1470, 800);
			ctx.fill();

            //Obstaculos
            for (let index = 0; index < cuadrados.length; index++) {
                ctx.beginPath();
			    ctx.fillStyle = "black";
                ctx.rect(cuadrados[index][0], cuadrados[index][1], cuadrados[index][2], cuadrados[index][2]);
                ctx.fill();
            }
			

			draw();
		}
        //
		function draw(){
			ctx.beginPath();
			ctx.fillStyle = "black";
			ctx.rect(x, y, w, w);
			ctx.stroke();
		}

		document.addEventListener("keydown", function (e){
			
			console.log(e.keyCode);
			switch(e.keyCode){
				case 87:
					dir = e.keyCode;
					break;
				case 83:
					dir = e.keyCode;
					break;
				case 68:
					dir = e.keyCode;
					break;
				case 65:
					dir = e.keyCode;
					break;
			}
		});

        let flag = false;
		function update(){
            //
            for(let findex = 0; findex < cuadrados.length; findex++){
                if(x < cuadrados[findex][0] + cuadrados[findex][2] &&  x + w > cuadrados[findex][0] && 
                   y < cuadrados[findex][1] + cuadrados[findex][2] &&  y + w > cuadrados[findex][1]){
                         cuadrados[findex][0] = (Math.floor(Math.random() * 1470));
                         cuadrados[findex][1] = (Math.floor(Math.random() * 800));
                         flag = true;
                         repaint();
                }   
            }
			switch(dir){
				case 87:
                    if(flag){
                        dir = 83;
                        flag = false;
                    }
					y-= 10;
					if(y<0) {y=800} else if(y>800){y=0}
					break;
				case 83:
                    if(flag){
                        dir = 87;
                        flag = false;
                    }
					y+= 10;
					if(y<0) {y=800} else if(y>800){y=0}
					break;
				case 68:
                    if(flag){
                        dir = 65;
                        flag = false;
                    }
					x+= 10;
					if(x<0) {x=1470} else if(x>1470){x=0}
					break;
				case 65:
                    if(flag){
                        dir = 68;
                        flag = false;
                    }
					x-= 10;
					if(x<0) {x=1470} else if(x>1470){x=0}
					break;
			}
			repaint();
			window.requestAnimationFrame(update);
		}

		window.requestAnimationFrame = (function () {
			return window.requestAnimationFrame ||
				window.webkitRequestAnimationFrame ||
				window.mozRequestAnimationFrame ||
				function (callback) {
					window.setTimeout(callback, 17);
				};
		}());
		window.requestAnimationFrame(update);
	</script>
</body>
</html>