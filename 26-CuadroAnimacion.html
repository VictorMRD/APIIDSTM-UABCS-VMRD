<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Canvas</title>
</head>
<body>
	<canvas id="myCanvas" width="500" height="500" style="border:1px solid #000000;"> Tu navegador no admite el elemento &lt;canvas&gt;. </canvas>
	<script>
		const canvas = document.getElementById("myCanvas");
		const ctx = canvas.getContext("2d");
		let y = 250, x=250;
		let dir = 0;

		function repaint(){
			ctx.beginPath();
			ctx.fillStyle = "white";
			ctx.rect(0, 0, 500, 500);
			ctx.fill();
			console.log("repaint")
			draw();
		}
		function draw(){
			ctx.beginPath();
			ctx.fillStyle = "black";
			ctx.rect(x, y, 150, 100);
			ctx.stroke();
			console.log("cuadro");
		}

		document.addEventListener("keydown", function (e){
			
			console.log(e.keyCode);
			switch(e.keyCode){
				case 87:
					dir = e.keyCode;
					break;
				case 83:
					dir = e.keyCode;
					break;
				case 68:
					dir = e.keyCode;
					break;
				case 65:
					dir = e.keyCode;
					break;
			}
		});

		function update(){
			switch(dir){
				case 87:
					y-= 10;
					if(y<0) {y=500} else if(y>500){y=0}
					console.log("moviendo y");
					break;
				case 83:
					y+= 10;
					if(y<0) {y=500} else if(y>500){y=0}
					console.log("moviendo y");
					break;
				case 68:
					x+= 10;
					if(x<0) {x=500} else if(x>500){x=0}
					console.log("moviendo x");
					break;
				case 65:
					x-= 10;
					if(x<0) {x=500} else if(x>500){x=0}
					console.log("moviendo x");
					break;
			}
			repaint();
			window.requestAnimationFrame(update);
		}

		window.requestAnimationFrame = (function () {
			return window.requestAnimationFrame ||
				window.webkitRequestAnimationFrame ||
				window.mozRequestAnimationFrame ||
				function (callback) {
					window.setTimeout(callback, 17);
				};
		}());
		window.requestAnimationFrame(update);
	</script>
</body>
</html>